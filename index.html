<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drag % vs Time</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h2>Drag % vs Time (Days)</h2>
    
    <label id="A1">Robot Area (B1) (mÂ²): <input type="range" id="robotArea" min="0.05" max="1" step="0.01" value="0.1" oninput="updateGraph()"></label>
    <label id="A3">Velocity (B3) (m/s): <input type="range" id="velocity" min="5" max="20" step="0.5" value="10" oninput="updateGraph()"></label>
    <label>Ship Length (m): <input type="range" id="shipLength" min="100" max="500" step="10" value="500" oninput="updateGraph()"></label>
    <label>Ship Width (m): <input type="range" id="shipWidth" min="10" max="100" step="5" value="50" oninput="updateGraph()"></label>
    <label>Ship Drag Height (m): <input type="range" id="shipDragHeight" min="1" max="20" step="1" value="10" oninput="updateGraph()"></label>
    
    
    <label>Clean Ship Cd: <input type="text" id="cleanCd" value="0.8" oninput="updateGraph()"></label>
    
    <label>Robot Cd: <input type="text" id="robotCd" value="0.8" oninput="updateGraph()"></label>
    <label>Number of Robots: <input type="text" id="numRobots" value="10" oninput="updateGraph()"></label>
    <label>Max Biofouling Height (m): <input type="text" id="maxBiofoul" value="0.0045" oninput="updateGraph()"></label>
    
    <canvas id="dragChart"></canvas>
    
    <script>
        function calculateDragPercentage(t) {
            let numRobots = parseFloat(document.getElementById("numRobots").value);
            let robotArea = parseFloat(document.getElementById("robotArea").value);
            let velocity = parseFloat(document.getElementById("velocity").value);
            let cleanCd = parseFloat(document.getElementById("cleanCd").value);
            
            let robotCd = parseFloat(document.getElementById("robotCd").value);
            let shipWidth = parseFloat(document.getElementById("shipWidth").value);
            let shipDragHeight = parseFloat(document.getElementById("shipDragHeight").value);
            let maxBiofoul = parseFloat(document.getElementById("maxBiofoul").value);
            
            
            let shipVelocity = velocity; 
            let foulingThickness = maxBiofoul / (1 + (maxBiofoul * 10000 - 1) * Math.exp(-0.1 * t));
            let dirtyShipCd = cleanCd * (1 + 30 * foulingThickness / shipDragHeight);
            
            let cleanShipDrag = 0.5 * 1025 * cleanCd * (shipWidth * shipDragHeight) * (shipVelocity ** 2);
            let dirtyShipDrag = 0.5 * dirtyShipCd * 1025 * ((shipWidth + 2 * foulingThickness) * (shipDragHeight + foulingThickness)) * (shipVelocity ** 2);
            let robotDragForce = numRobots * 0.5 * 1025 * robotCd * robotArea * (shipVelocity ** 2);
            
            let dragCleanShip = 100;
            let dragDirtyShip = ((dirtyShipDrag - cleanShipDrag) / cleanShipDrag) * 100 + 100;
            let dragWithRobot = (robotDragForce / cleanShipDrag) * 100 + 100;
            
            return { dragCleanShip, dragDirtyShip, dragWithRobot };
        }
        
        function updateGraph() {
            let time = Array.from({length: 19}, (_, i) => i * 10);
            let cleanData = [], dirtyData = [], robotData = [];
            
            for (let t of time) {
                let dragValues = calculateDragPercentage(t);
                cleanData.push(dragValues.dragCleanShip);
                dirtyData.push(dragValues.dragDirtyShip);
                robotData.push(dragValues.dragWithRobot);
            }
            
            dragChart.data.labels = time;
            dragChart.data.datasets[0].data = cleanData;
            dragChart.data.datasets[1].data = dirtyData;
            dragChart.data.datasets[2].data = robotData;
            dragChart.update();
        }
        
        let ctx = document.getElementById("dragChart").getContext("2d");
        let dragChart = new Chart(ctx, {
            type: "line",
            data: {
                labels: [],
                datasets: [
                    { label: "% Drag Clean Ship", borderColor: "green", data: [], fill: false },
                    { label: "% Drag Dirty Ship", borderColor: "red", data: [], fill: false },
                    { label: "% Drag With Robot", borderColor: "blue", data: [], fill: false }
                ]
            },
            options: {
                responsive: true,
                scales: { x: { title: { display: true, text: "Time (Days)" } }, y: { title: { display: true, text: "% Drag" } } }
            }
        });
        
        updateGraph();
    </script>
</body>
</html>
