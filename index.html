<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Drag Force Simulation - Clean Ship</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
        }
        .slider-container {
            margin: 10px;
        }
        .chart-container {
            width: 90%;
            max-width: 900px;
            margin: auto;
        }
        canvas {
            width: 100% !important;
            height: auto !important;
            max-height: 80vh;
        }
    </style>
</head>
<body>

    <h2>Drag Force Simulation for a Clean Ship</h2>
    <p>Adjust the sliders to see how the drag force changes over time for a clean ship.</p>

    <!-- Ship Inputs -->
    <div class="slider-container">
        <label>Ship Length (m): <span id="lengthValue">100</span></label>
        <input type="number" id="lengthInput" min="1" max="1000" step="1" value="100">
    </div>

    <div class="slider-container">
        <label>Ship Width (m): <span id="widthValue">30</span></label>
        <input type="number" id="widthInput" min="1" max="1000" step="1" value="30">
    </div>

    <div class="slider-container">
        <label>Ship Drag Height (m): <span id="heightValue">5</span></label>
        <input type="number" id="heightInput" min="1" max="100" step="1" value="5">
    </div>

    <div class="slider-container">
        <label>Ship Drag Coefficient (Cd): <span id="cdValue">0.003</span></label>
        <input type="number" id="cdInput" min="0.001" max="1" step="0.001" value="0.003">
    </div>

    <div class="slider-container">
        <label>Ship Speed (knots): <span id="velocityValue">10.0</span></label>
        <input type="range" id="velocitySlider" min="0" max="30" step="0.1" value="10">
    </div>

    <div class="slider-container">
        <label>Water Density (kg/m³): <span id="densityValue">1025</span></label>
        <input type="number" id="densityInput" min="900" max="1200" step="1" value="1025">
    </div>

    <!-- Chart Container for Drag Force over Time -->
    <div class="chart-container">
        <canvas id="dragForceChart"></canvas>
    </div>

    <script>
        // Constants
        const rho = 1025; // Default water density in kg/m³ (Seawater)
        const daysInYear = 365; // Simulate for 1 year (365 days)

        // Get input elements
        const lengthInput = document.getElementById("lengthInput");
        const widthInput = document.getElementById("widthInput");
        const heightInput = document.getElementById("heightInput");
        const cdInput = document.getElementById("cdInput");
        const velocitySlider = document.getElementById("velocitySlider");
        const densityInput = document.getElementById("densityInput");

        // Get display elements
        const lengthValue = document.getElementById("lengthValue");
        const widthValue = document.getElementById("widthValue");
        const heightValue = document.getElementById("heightValue");
        const cdValue = document.getElementById("cdValue");
        const velocityValue = document.getElementById("velocityValue");
        const densityValue = document.getElementById("densityValue");

        // Function to calculate drag force
        function calculateDragForce(Cd, width, dragHeight, velocity, rho) {
            // Calculate frontal area A (width * dragHeight)
            const A = width * dragHeight;
            return 0.5 * rho * Cd * A * velocity * velocity;
        }

        // Initialize Chart.js
        const ctx = document.getElementById("dragForceChart").getContext("2d");

        let dragForceChart = new Chart(ctx, {
            type: "line",
            data: {
                labels: Array.from({ length: daysInYear }, (_, i) => i), // Days from 0 to 365
                datasets: [
                    {
                        label: "Clean Ship Drag Force (N)",
                        data: [],
                        borderColor: "blue",
                        backgroundColor: "rgba(0, 0, 255, 0.2)",
                        fill: true,
                    }
                ]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                scales: {
                    x: {
                        title: { display: true, text: "Time (Days)" },
                    },
                    y: {
                        title: { display: true, text: "Drag Force (N)" },
                        beginAtZero: false,
                        ticks: {
                            callback: function(value) {
                                return value.toExponential(3); // Display in scientific notation
                            }
                        }
                    }
                }
            }
        });

        // Function to update simulation
        function updateSimulation() {
            // Get values from inputs
            const length = parseFloat(lengthInput.value);
            const width = parseFloat(widthInput.value);
            const dragHeight = parseFloat(heightInput.value);
            const Cd_clean = parseFloat(cdInput.value);
            const velocity_knots = parseFloat(velocitySlider.value);
            const rho = parseFloat(densityInput.value);

            // Update displayed values
            lengthValue.textContent = length.toFixed(2);
            widthValue.textContent = width.toFixed(2);
            heightValue.textContent = dragHeight.toFixed(2);
            cdValue.textContent = Cd_clean.toFixed(3);
            velocityValue.textContent = velocity_knots.toFixed(1);
            densityValue.textContent = rho.toFixed(0);

            // Convert speed from knots to m/s
            const velocity = velocity_knots * 0.514444;

            // Calculate drag force for the clean ship
            const dragForce = calculateDragForce(Cd_clean, width, dragHeight, velocity, rho);

            // Generate drag force over time (simulating for 365 days)
            const dragForcesOverTime = Array.from({ length: daysInYear }, (_, day) => dragForce);

            // Update the chart with drag forces
            dragForceChart.data.datasets[0].data = dragForcesOverTime;
            dragForceChart.update();
        }

        // Call the update function to initialize the chart
        updateSimulation();

        // Add event listeners to update simulation when inputs change
        lengthInput.addEventListener("input", updateSimulation);
        widthInput.addEventListener("input", updateSimulation);
        heightInput.addEventListener("input", updateSimulation);
        cdInput.addEventListener("input", updateSimulation);
        velocitySlider.addEventListener("input", updateSimulation);
        densityInput.addEventListener("input", updateSimulation);

    </script>
</body>
</html>
